STEP: 0
opt.datasetvoc
lalallal
15-1
[1, 1, 15]
curr_idx= [0, 16]
==============================================
  task : 15-1
  step : 0
  Device: cuda
  opts : 
Namespace(KDLoss=True, KDLoss_prelogit=True, amp=True, batch_size=1, bn_freeze=True, ckpt=None, conloss_proposal=True, conloss_prototype=True, crop_size=513, crop_val=True, curr_itrs=0, curr_step=0, data_root='/opt/data/private/zzk/dataset/VOCdevkit/VOC2012/', dataset='voc', device=device(type='cuda'), freeze=False, freeze_low=True, gpu_id='0', loss_tred=True, loss_type='bce_loss', lr=0.0001, lr_policy='poly', mem_size=100, merge_proposal_num=100, model='deeplabv3_swin_transformer', name='swin_voc2012_best', not_loss_proposal=False, num_classes=[1, 1, 15], output_stride=16, overlap=True, prev_classes=2, print_interval=10, proposal_channel=100, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step='0,1,2,3,4,5', step_size=10000, sum_classes=15, task='15-1', test_only=True, test_val=False, train_epoch=50, unknown=True, unknown_cluster=1, val_batch_size=1, val_interval=100, w_transfer=True, weight_decay=0.0001)
==============================================
ModuleList(
  (0): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (1): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (2): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
)
optim_type:ADAMW
----------- trainable parameters --------------
backbone.model.patch_embed.proj.weight torch.Size([128, 3, 4, 4])
backbone.model.patch_embed.proj.bias torch.Size([128])
backbone.model.patch_embed.norm.weight torch.Size([128])
backbone.model.patch_embed.norm.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.0.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.0.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.0.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.0.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.0.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.0.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.0.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.0.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.0.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.1.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.1.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.1.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.1.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.1.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.1.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.1.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.1.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.downsample.reduction.weight torch.Size([256, 512])
backbone.model.layers.0.downsample.norm.weight torch.Size([512])
backbone.model.layers.0.downsample.norm.bias torch.Size([512])
backbone.model.layers.1.blocks.0.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.0.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.0.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.0.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.0.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.0.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.0.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.0.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.0.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.0.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.1.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.1.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.1.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.1.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.1.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.1.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.1.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.1.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.downsample.reduction.weight torch.Size([512, 1024])
backbone.model.layers.1.downsample.norm.weight torch.Size([1024])
backbone.model.layers.1.downsample.norm.bias torch.Size([1024])
backbone.model.layers.2.blocks.0.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.0.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.0.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.0.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.0.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.0.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.0.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.0.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.0.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.0.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.1.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.1.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.1.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.1.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.1.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.1.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.1.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.1.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.2.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.2.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.2.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.2.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.2.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.2.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.2.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.2.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.3.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.3.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.3.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.3.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.3.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.3.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.3.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.3.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.4.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.4.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.4.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.4.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.4.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.4.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.4.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.4.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.5.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.5.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.5.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.5.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.5.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.5.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.5.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.5.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.6.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.6.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.6.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.6.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.6.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.6.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.6.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.6.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.7.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.7.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.7.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.7.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.7.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.7.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.7.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.7.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.8.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.8.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.8.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.8.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.8.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.8.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.8.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.8.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.9.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.9.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.9.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.9.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.9.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.9.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.9.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.9.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.10.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.10.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.10.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.10.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.10.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.10.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.10.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.10.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.11.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.11.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.11.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.11.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.11.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.11.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.11.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.11.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.12.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.12.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.12.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.12.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.12.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.12.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.12.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.12.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.13.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.13.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.13.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.13.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.13.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.13.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.13.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.13.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.14.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.14.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.14.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.14.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.14.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.14.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.14.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.14.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.15.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.15.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.15.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.15.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.15.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.15.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.15.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.15.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.16.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.16.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.16.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.16.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.16.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.16.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.16.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.16.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.17.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.17.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.17.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.17.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.17.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.17.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.17.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.17.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.downsample.reduction.weight torch.Size([1024, 2048])
backbone.model.layers.2.downsample.norm.weight torch.Size([2048])
backbone.model.layers.2.downsample.norm.bias torch.Size([2048])
backbone.model.layers.3.blocks.0.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.0.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.0.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.0.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.0.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.0.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.0.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.0.mlp.fc2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.1.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.1.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.1.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.1.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.1.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.1.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.1.mlp.fc2.bias torch.Size([1024])
backbone.model.norm0.weight torch.Size([128])
backbone.model.norm0.bias torch.Size([128])
backbone.model.norm1.weight torch.Size([256])
backbone.model.norm1.bias torch.Size([256])
backbone.model.norm2.weight torch.Size([512])
backbone.model.norm2.bias torch.Size([512])
backbone.model.norm3.weight torch.Size([1024])
backbone.model.norm3.bias torch.Size([1024])
classifier.aspp.convs.0.0.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.0.1.weight torch.Size([256])
classifier.aspp.convs.0.1.bias torch.Size([256])
classifier.aspp.convs.1.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.1.1.weight torch.Size([256])
classifier.aspp.convs.1.1.bias torch.Size([256])
classifier.aspp.convs.2.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.2.1.weight torch.Size([256])
classifier.aspp.convs.2.1.bias torch.Size([256])
classifier.aspp.convs.3.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.3.1.weight torch.Size([256])
classifier.aspp.convs.3.1.bias torch.Size([256])
classifier.aspp.convs.4.1.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.4.2.weight torch.Size([256])
classifier.aspp.convs.4.2.bias torch.Size([256])
classifier.aspp.project.0.weight torch.Size([256, 1280, 1, 1])
classifier.aspp.project.1.weight torch.Size([256])
classifier.aspp.project.1.bias torch.Size([256])
classifier.head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.head.0.1.weight torch.Size([256])
classifier.head.0.1.bias torch.Size([256])
classifier.head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.head.1.1.weight torch.Size([256])
classifier.head.1.1.bias torch.Size([256])
classifier.head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.head.2.1.weight torch.Size([256])
classifier.head.2.1.bias torch.Size([256])
classifier.head2.0.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.0.0.bias torch.Size([1])
classifier.head2.1.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.1.0.bias torch.Size([1])
classifier.head2.2.0.weight torch.Size([15, 256, 1, 1])
classifier.head2.2.0.bias torch.Size([15])
classifier.proposal_head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.1.weight torch.Size([256])
classifier.proposal_head.0.1.bias torch.Size([256])
classifier.proposal_head.0.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.4.weight torch.Size([256])
classifier.proposal_head.0.4.bias torch.Size([256])
classifier.proposal_head.0.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.7.weight torch.Size([256])
classifier.proposal_head.0.7.bias torch.Size([256])
classifier.proposal_head.0.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.0.9.bias torch.Size([1])
classifier.proposal_head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.1.weight torch.Size([256])
classifier.proposal_head.1.1.bias torch.Size([256])
classifier.proposal_head.1.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.4.weight torch.Size([256])
classifier.proposal_head.1.4.bias torch.Size([256])
classifier.proposal_head.1.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.7.weight torch.Size([256])
classifier.proposal_head.1.7.bias torch.Size([256])
classifier.proposal_head.1.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.1.9.bias torch.Size([1])
classifier.proposal_head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.1.weight torch.Size([256])
classifier.proposal_head.2.1.bias torch.Size([256])
classifier.proposal_head.2.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.4.weight torch.Size([256])
classifier.proposal_head.2.4.bias torch.Size([256])
classifier.proposal_head.2.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.7.weight torch.Size([256])
classifier.proposal_head.2.7.bias torch.Size([256])
classifier.proposal_head.2.9.weight torch.Size([15, 256, 1, 1])
classifier.proposal_head.2.9.bias torch.Size([15])
-----------------------------------------------
[!] Retrain
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)9568 len(self.masks)9568
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setval
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modeval
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)1240 len(self.masks)1240
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settest
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)1449 len(self.masks)1449
Dataset: voc, Train set: 9568, Val set: 1240, Test set: 1449
... train epoch : 50 , iterations : 478400 , val_interval : 4784
test ckpt_dir checkpoints/%s/%s_%s_%s_step_%d_overlap.pth
best_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_0_overlap.pth
color [128   0   0]
(16,)

Overall Acc: 0.968005
Mean Acc: 0.920128
FreqW Acc: 0.941310
Mean IoU: 0.848122
Mean IoU(per pixel): 0.937993
Class IoU/Acc/Recall:
\background: 0.9602 (miou) , 0.9808 (acc) , 0.9786 (rec) 
\aeroplane: 0.9101 (miou) , 0.9542 (acc) , 0.9517 (rec) 
\bicycle: 0.4227 (miou) , 0.8813 (acc) , 0.4482 (rec) 
\bird: 0.9526 (miou) , 0.9774 (acc) , 0.9741 (rec) 
\boat: 0.7556 (miou) , 0.9019 (acc) , 0.8232 (rec) 
\bottle: 0.8668 (miou) , 0.9521 (acc) , 0.9064 (rec) 
\bus: 0.9491 (miou) , 0.9759 (acc) , 0.9719 (rec) 
\car: 0.9012 (miou) , 0.9215 (acc) , 0.9762 (rec) 
\cat: 0.9619 (miou) , 0.9845 (acc) , 0.9767 (rec) 
\chair: 0.5621 (miou) , 0.6713 (acc) , 0.7756 (rec) 
\cow: 0.9490 (miou) , 0.9769 (acc) , 0.9708 (rec) 
\diningtable: 0.6643 (miou) , 0.7169 (acc) , 0.9006 (rec) 
\dog: 0.9518 (miou) , 0.9695 (acc) , 0.9812 (rec) 
\horse: 0.9297 (miou) , 0.9576 (acc) , 0.9696 (rec) 
\motorbike: 0.9280 (miou) , 0.9648 (acc) , 0.9606 (rec) 
\person: 0.9048 (miou) , 0.9355 (acc) , 0.9651 (rec) 

[0.9601535167686407, 0.9100665528684565, 0.4226532691668895, 0.9526403040471739, 0.7555805465221551, 0.8668447642053773, 0.9490825703857714, 0.9012235241780977, 0.9619330292145428, 0.5621209246382204, 0.9489680552435397, 0.6643267335960804, 0.951786496884198, 0.9296889265099291, 0.9280469751064843, 0.9048325308634922]
13.569948720199049
16
...from 0 to 15 : best/test_before_mIoU : 0.848122
[]
...from 16 to 15 best/test_after_mIoU : nan
...from 0 to 15 : best/test_before_acc : 0.920128
...from 16 to 15 best/test_after_acc : nan
STEP: 1
opt.datasetvoc
lalallal
15-1
[1, 1, 15, 1]
curr_idx= [16, 17]
==============================================
  task : 15-1
  step : 1
  Device: cuda
  opts : 
Namespace(KDLoss=True, KDLoss_prelogit=True, amp=True, batch_size=1, bn_freeze=True, ckpt=None, conloss_proposal=True, conloss_prototype=True, crop_size=513, crop_val=True, curr_itrs=0, curr_step=1, data_root='/opt/data/private/zzk/dataset/VOCdevkit/VOC2012/', dataset='voc', device=device(type='cuda'), freeze=False, freeze_low=True, gpu_id='0', loss_tred=True, loss_type='bce_loss', lr=0.0001, lr_policy='poly', mem_size=100, merge_proposal_num=100, model='deeplabv3_swin_transformer', name='swin_voc2012_best', not_loss_proposal=False, num_classes=[1, 1, 15, 1], output_stride=16, overlap=True, prev_classes=17, print_interval=10, proposal_channel=100, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step='0,1,2,3,4,5', step_size=10000, sum_classes=16, task='15-1', test_only=True, test_val=False, train_epoch=50, unknown=True, unknown_cluster=1, val_batch_size=1, val_interval=100, w_transfer=True, weight_decay=0.0001)
==============================================
ModuleList(
  (0): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (1): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (2): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (3): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
)
optim_type:ADAMW
----------- trainable parameters --------------
backbone.model.patch_embed.proj.weight torch.Size([128, 3, 4, 4])
backbone.model.patch_embed.proj.bias torch.Size([128])
backbone.model.patch_embed.norm.weight torch.Size([128])
backbone.model.patch_embed.norm.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.0.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.0.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.0.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.0.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.0.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.0.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.0.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.0.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.0.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.1.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.1.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.1.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.1.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.1.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.1.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.1.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.1.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.downsample.reduction.weight torch.Size([256, 512])
backbone.model.layers.0.downsample.norm.weight torch.Size([512])
backbone.model.layers.0.downsample.norm.bias torch.Size([512])
backbone.model.layers.1.blocks.0.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.0.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.0.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.0.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.0.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.0.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.0.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.0.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.0.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.0.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.1.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.1.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.1.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.1.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.1.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.1.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.1.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.1.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.downsample.reduction.weight torch.Size([512, 1024])
backbone.model.layers.1.downsample.norm.weight torch.Size([1024])
backbone.model.layers.1.downsample.norm.bias torch.Size([1024])
backbone.model.layers.2.blocks.0.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.0.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.0.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.0.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.0.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.0.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.0.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.0.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.0.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.0.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.1.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.1.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.1.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.1.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.1.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.1.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.1.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.1.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.2.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.2.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.2.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.2.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.2.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.2.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.2.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.2.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.3.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.3.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.3.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.3.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.3.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.3.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.3.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.3.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.4.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.4.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.4.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.4.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.4.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.4.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.4.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.4.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.5.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.5.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.5.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.5.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.5.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.5.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.5.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.5.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.6.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.6.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.6.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.6.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.6.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.6.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.6.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.6.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.7.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.7.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.7.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.7.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.7.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.7.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.7.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.7.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.8.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.8.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.8.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.8.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.8.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.8.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.8.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.8.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.9.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.9.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.9.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.9.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.9.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.9.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.9.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.9.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.10.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.10.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.10.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.10.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.10.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.10.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.10.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.10.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.11.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.11.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.11.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.11.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.11.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.11.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.11.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.11.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.12.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.12.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.12.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.12.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.12.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.12.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.12.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.12.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.13.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.13.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.13.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.13.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.13.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.13.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.13.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.13.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.14.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.14.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.14.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.14.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.14.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.14.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.14.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.14.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.15.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.15.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.15.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.15.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.15.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.15.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.15.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.15.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.16.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.16.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.16.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.16.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.16.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.16.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.16.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.16.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.17.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.17.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.17.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.17.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.17.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.17.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.17.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.17.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.downsample.reduction.weight torch.Size([1024, 2048])
backbone.model.layers.2.downsample.norm.weight torch.Size([2048])
backbone.model.layers.2.downsample.norm.bias torch.Size([2048])
backbone.model.layers.3.blocks.0.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.0.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.0.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.0.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.0.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.0.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.0.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.0.mlp.fc2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.1.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.1.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.1.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.1.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.1.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.1.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.1.mlp.fc2.bias torch.Size([1024])
backbone.model.norm0.weight torch.Size([128])
backbone.model.norm0.bias torch.Size([128])
backbone.model.norm1.weight torch.Size([256])
backbone.model.norm1.bias torch.Size([256])
backbone.model.norm2.weight torch.Size([512])
backbone.model.norm2.bias torch.Size([512])
backbone.model.norm3.weight torch.Size([1024])
backbone.model.norm3.bias torch.Size([1024])
classifier.aspp.convs.0.0.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.0.1.weight torch.Size([256])
classifier.aspp.convs.0.1.bias torch.Size([256])
classifier.aspp.convs.1.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.1.1.weight torch.Size([256])
classifier.aspp.convs.1.1.bias torch.Size([256])
classifier.aspp.convs.2.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.2.1.weight torch.Size([256])
classifier.aspp.convs.2.1.bias torch.Size([256])
classifier.aspp.convs.3.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.3.1.weight torch.Size([256])
classifier.aspp.convs.3.1.bias torch.Size([256])
classifier.aspp.convs.4.1.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.4.2.weight torch.Size([256])
classifier.aspp.convs.4.2.bias torch.Size([256])
classifier.aspp.project.0.weight torch.Size([256, 1280, 1, 1])
classifier.aspp.project.1.weight torch.Size([256])
classifier.aspp.project.1.bias torch.Size([256])
classifier.head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.head.0.1.weight torch.Size([256])
classifier.head.0.1.bias torch.Size([256])
classifier.head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.head.1.1.weight torch.Size([256])
classifier.head.1.1.bias torch.Size([256])
classifier.head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.head.2.1.weight torch.Size([256])
classifier.head.2.1.bias torch.Size([256])
classifier.head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.head.3.1.weight torch.Size([256])
classifier.head.3.1.bias torch.Size([256])
classifier.head2.0.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.0.0.bias torch.Size([1])
classifier.head2.1.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.1.0.bias torch.Size([1])
classifier.head2.2.0.weight torch.Size([15, 256, 1, 1])
classifier.head2.2.0.bias torch.Size([15])
classifier.head2.3.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.3.0.bias torch.Size([1])
classifier.proposal_head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.1.weight torch.Size([256])
classifier.proposal_head.0.1.bias torch.Size([256])
classifier.proposal_head.0.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.4.weight torch.Size([256])
classifier.proposal_head.0.4.bias torch.Size([256])
classifier.proposal_head.0.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.7.weight torch.Size([256])
classifier.proposal_head.0.7.bias torch.Size([256])
classifier.proposal_head.0.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.0.9.bias torch.Size([1])
classifier.proposal_head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.1.weight torch.Size([256])
classifier.proposal_head.1.1.bias torch.Size([256])
classifier.proposal_head.1.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.4.weight torch.Size([256])
classifier.proposal_head.1.4.bias torch.Size([256])
classifier.proposal_head.1.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.7.weight torch.Size([256])
classifier.proposal_head.1.7.bias torch.Size([256])
classifier.proposal_head.1.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.1.9.bias torch.Size([1])
classifier.proposal_head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.1.weight torch.Size([256])
classifier.proposal_head.2.1.bias torch.Size([256])
classifier.proposal_head.2.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.4.weight torch.Size([256])
classifier.proposal_head.2.4.bias torch.Size([256])
classifier.proposal_head.2.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.7.weight torch.Size([256])
classifier.proposal_head.2.7.bias torch.Size([256])
classifier.proposal_head.2.9.weight torch.Size([15, 256, 1, 1])
classifier.proposal_head.2.9.bias torch.Size([15])
classifier.proposal_head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.1.weight torch.Size([256])
classifier.proposal_head.3.1.bias torch.Size([256])
classifier.proposal_head.3.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.4.weight torch.Size([256])
classifier.proposal_head.3.4.bias torch.Size([256])
classifier.proposal_head.3.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.7.weight torch.Size([256])
classifier.proposal_head.3.7.bias torch.Size([256])
classifier.proposal_head.3.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.3.9.bias torch.Size([1])
-----------------------------------------------
prev_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_0_overlap.pth
... weight transfer
Model restored from checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_0_overlap.pth
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)9568 len(self.masks)9568
...start memory candidates collection
...end memory candidates collection :  9568
...start memory list generation
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)487 len(self.masks)487
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setval
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modeval
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)85 len(self.masks)85
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settest
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)1449 len(self.masks)1449
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setmemory
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
memory json location
./datasets/data/swin_voc2012_best_15-1/memory.json
... memory list :  100 [16, 255, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)100 len(self.masks)100
Dataset: voc, Train set: 487, Val set: 85, Test set: 1449
... train epoch : 50 , iterations : 24350 , val_interval : 243
test ckpt_dir checkpoints/%s/%s_%s_%s_step_%d_overlap.pth
best_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_1_overlap.pth
color [128   0   0]
(17,)

Overall Acc: 0.964652
Mean Acc: 0.909460
FreqW Acc: 0.935351
Mean IoU: 0.830419
Mean IoU(per pixel): 0.931719
Class IoU/Acc/Recall:
\background: 0.9557 (miou) , 0.9790 (acc) , 0.9757 (rec) 
\aeroplane: 0.9067 (miou) , 0.9539 (acc) , 0.9483 (rec) 
\bicycle: 0.4284 (miou) , 0.8652 (acc) , 0.4590 (rec) 
\bird: 0.9512 (miou) , 0.9749 (acc) , 0.9750 (rec) 
\boat: 0.7442 (miou) , 0.9024 (acc) , 0.8094 (rec) 
\bottle: 0.8609 (miou) , 0.9525 (acc) , 0.8995 (rec) 
\bus: 0.9491 (miou) , 0.9753 (acc) , 0.9724 (rec) 
\car: 0.9016 (miou) , 0.9212 (acc) , 0.9769 (rec) 
\cat: 0.9627 (miou) , 0.9827 (acc) , 0.9793 (rec) 
\chair: 0.5262 (miou) , 0.6146 (acc) , 0.7852 (rec) 
\cow: 0.9483 (miou) , 0.9760 (acc) , 0.9710 (rec) 
\diningtable: 0.6567 (miou) , 0.6907 (acc) , 0.9303 (rec) 
\dog: 0.9580 (miou) , 0.9744 (acc) , 0.9828 (rec) 
\horse: 0.9244 (miou) , 0.9572 (acc) , 0.9642 (rec) 
\motorbike: 0.9223 (miou) , 0.9604 (acc) , 0.9588 (rec) 
\person: 0.9025 (miou) , 0.9290 (acc) , 0.9694 (rec) 
\pottedplant: 0.6183 (miou) , 0.8513 (acc) , 0.6932 (rec) 

[0.9557074327015842, 0.9067212862024093, 0.4283510254198302, 0.9511611707090031, 0.7442261892279218, 0.8609055231612616, 0.9490566684990992, 0.9015753735866439, 0.9626669051331963, 0.5261737908917378, 0.9483289506682395, 0.6567460154161273, 0.9579976340839307, 0.924363522149616, 0.9223016722029508, 0.9025342624564898]
13.498817422510042
16
...from 0 to 15 : best/test_before_mIoU : 0.843676
[0.6183065606528787]
...from 16 to 16 best/test_after_mIoU : 0.618307
...from 0 to 15 : best/test_before_acc : 0.913093
...from 16 to 16 best/test_after_acc : 0.851331
STEP: 2
opt.datasetvoc
lalallal
15-1
[1, 1, 15, 1, 1]
curr_idx= [17, 18]
==============================================
  task : 15-1
  step : 2
  Device: cuda
  opts : 
Namespace(KDLoss=True, KDLoss_prelogit=True, amp=True, batch_size=1, bn_freeze=True, ckpt='checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_0_overlap.pth', conloss_proposal=True, conloss_prototype=True, crop_size=513, crop_val=True, curr_itrs=0, curr_step=2, data_root='/opt/data/private/zzk/dataset/VOCdevkit/VOC2012/', dataset='voc', device=device(type='cuda'), freeze=False, freeze_low=True, gpu_id='0', loss_tred=True, loss_type='bce_loss', lr=0.0001, lr_policy='poly', mem_size=100, merge_proposal_num=100, model='deeplabv3_swin_transformer', name='swin_voc2012_best', not_loss_proposal=False, num_classes=[1, 1, 15, 1, 1], output_stride=16, overlap=True, prev_classes=18, print_interval=10, proposal_channel=100, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step='0,1,2,3,4,5', step_size=10000, sum_classes=17, task='15-1', test_only=True, test_val=False, train_epoch=50, unknown=True, unknown_cluster=1, val_batch_size=1, val_interval=100, w_transfer=True, weight_decay=0.0001)
==============================================
ModuleList(
  (0): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (1): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (2): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (3): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (4): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
)
optim_type:ADAMW
----------- trainable parameters --------------
backbone.model.patch_embed.proj.weight torch.Size([128, 3, 4, 4])
backbone.model.patch_embed.proj.bias torch.Size([128])
backbone.model.patch_embed.norm.weight torch.Size([128])
backbone.model.patch_embed.norm.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.0.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.0.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.0.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.0.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.0.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.0.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.0.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.0.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.0.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.1.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.1.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.1.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.1.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.1.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.1.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.1.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.1.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.downsample.reduction.weight torch.Size([256, 512])
backbone.model.layers.0.downsample.norm.weight torch.Size([512])
backbone.model.layers.0.downsample.norm.bias torch.Size([512])
backbone.model.layers.1.blocks.0.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.0.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.0.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.0.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.0.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.0.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.0.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.0.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.0.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.0.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.1.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.1.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.1.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.1.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.1.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.1.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.1.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.1.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.downsample.reduction.weight torch.Size([512, 1024])
backbone.model.layers.1.downsample.norm.weight torch.Size([1024])
backbone.model.layers.1.downsample.norm.bias torch.Size([1024])
backbone.model.layers.2.blocks.0.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.0.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.0.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.0.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.0.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.0.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.0.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.0.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.0.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.0.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.1.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.1.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.1.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.1.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.1.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.1.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.1.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.1.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.2.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.2.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.2.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.2.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.2.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.2.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.2.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.2.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.3.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.3.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.3.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.3.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.3.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.3.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.3.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.3.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.4.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.4.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.4.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.4.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.4.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.4.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.4.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.4.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.5.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.5.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.5.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.5.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.5.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.5.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.5.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.5.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.6.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.6.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.6.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.6.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.6.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.6.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.6.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.6.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.7.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.7.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.7.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.7.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.7.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.7.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.7.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.7.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.8.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.8.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.8.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.8.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.8.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.8.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.8.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.8.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.9.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.9.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.9.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.9.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.9.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.9.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.9.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.9.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.10.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.10.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.10.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.10.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.10.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.10.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.10.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.10.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.11.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.11.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.11.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.11.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.11.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.11.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.11.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.11.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.12.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.12.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.12.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.12.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.12.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.12.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.12.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.12.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.13.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.13.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.13.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.13.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.13.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.13.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.13.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.13.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.14.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.14.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.14.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.14.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.14.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.14.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.14.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.14.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.15.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.15.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.15.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.15.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.15.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.15.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.15.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.15.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.16.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.16.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.16.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.16.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.16.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.16.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.16.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.16.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.17.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.17.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.17.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.17.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.17.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.17.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.17.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.17.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.downsample.reduction.weight torch.Size([1024, 2048])
backbone.model.layers.2.downsample.norm.weight torch.Size([2048])
backbone.model.layers.2.downsample.norm.bias torch.Size([2048])
backbone.model.layers.3.blocks.0.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.0.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.0.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.0.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.0.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.0.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.0.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.0.mlp.fc2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.1.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.1.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.1.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.1.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.1.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.1.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.1.mlp.fc2.bias torch.Size([1024])
backbone.model.norm0.weight torch.Size([128])
backbone.model.norm0.bias torch.Size([128])
backbone.model.norm1.weight torch.Size([256])
backbone.model.norm1.bias torch.Size([256])
backbone.model.norm2.weight torch.Size([512])
backbone.model.norm2.bias torch.Size([512])
backbone.model.norm3.weight torch.Size([1024])
backbone.model.norm3.bias torch.Size([1024])
classifier.aspp.convs.0.0.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.0.1.weight torch.Size([256])
classifier.aspp.convs.0.1.bias torch.Size([256])
classifier.aspp.convs.1.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.1.1.weight torch.Size([256])
classifier.aspp.convs.1.1.bias torch.Size([256])
classifier.aspp.convs.2.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.2.1.weight torch.Size([256])
classifier.aspp.convs.2.1.bias torch.Size([256])
classifier.aspp.convs.3.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.3.1.weight torch.Size([256])
classifier.aspp.convs.3.1.bias torch.Size([256])
classifier.aspp.convs.4.1.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.4.2.weight torch.Size([256])
classifier.aspp.convs.4.2.bias torch.Size([256])
classifier.aspp.project.0.weight torch.Size([256, 1280, 1, 1])
classifier.aspp.project.1.weight torch.Size([256])
classifier.aspp.project.1.bias torch.Size([256])
classifier.head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.head.0.1.weight torch.Size([256])
classifier.head.0.1.bias torch.Size([256])
classifier.head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.head.1.1.weight torch.Size([256])
classifier.head.1.1.bias torch.Size([256])
classifier.head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.head.2.1.weight torch.Size([256])
classifier.head.2.1.bias torch.Size([256])
classifier.head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.head.3.1.weight torch.Size([256])
classifier.head.3.1.bias torch.Size([256])
classifier.head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.head.4.1.weight torch.Size([256])
classifier.head.4.1.bias torch.Size([256])
classifier.head2.0.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.0.0.bias torch.Size([1])
classifier.head2.1.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.1.0.bias torch.Size([1])
classifier.head2.2.0.weight torch.Size([15, 256, 1, 1])
classifier.head2.2.0.bias torch.Size([15])
classifier.head2.3.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.3.0.bias torch.Size([1])
classifier.head2.4.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.4.0.bias torch.Size([1])
classifier.proposal_head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.1.weight torch.Size([256])
classifier.proposal_head.0.1.bias torch.Size([256])
classifier.proposal_head.0.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.4.weight torch.Size([256])
classifier.proposal_head.0.4.bias torch.Size([256])
classifier.proposal_head.0.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.7.weight torch.Size([256])
classifier.proposal_head.0.7.bias torch.Size([256])
classifier.proposal_head.0.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.0.9.bias torch.Size([1])
classifier.proposal_head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.1.weight torch.Size([256])
classifier.proposal_head.1.1.bias torch.Size([256])
classifier.proposal_head.1.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.4.weight torch.Size([256])
classifier.proposal_head.1.4.bias torch.Size([256])
classifier.proposal_head.1.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.7.weight torch.Size([256])
classifier.proposal_head.1.7.bias torch.Size([256])
classifier.proposal_head.1.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.1.9.bias torch.Size([1])
classifier.proposal_head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.1.weight torch.Size([256])
classifier.proposal_head.2.1.bias torch.Size([256])
classifier.proposal_head.2.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.4.weight torch.Size([256])
classifier.proposal_head.2.4.bias torch.Size([256])
classifier.proposal_head.2.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.7.weight torch.Size([256])
classifier.proposal_head.2.7.bias torch.Size([256])
classifier.proposal_head.2.9.weight torch.Size([15, 256, 1, 1])
classifier.proposal_head.2.9.bias torch.Size([15])
classifier.proposal_head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.1.weight torch.Size([256])
classifier.proposal_head.3.1.bias torch.Size([256])
classifier.proposal_head.3.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.4.weight torch.Size([256])
classifier.proposal_head.3.4.bias torch.Size([256])
classifier.proposal_head.3.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.7.weight torch.Size([256])
classifier.proposal_head.3.7.bias torch.Size([256])
classifier.proposal_head.3.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.3.9.bias torch.Size([1])
classifier.proposal_head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.1.weight torch.Size([256])
classifier.proposal_head.4.1.bias torch.Size([256])
classifier.proposal_head.4.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.4.weight torch.Size([256])
classifier.proposal_head.4.4.bias torch.Size([256])
classifier.proposal_head.4.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.7.weight torch.Size([256])
classifier.proposal_head.4.7.bias torch.Size([256])
classifier.proposal_head.4.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.4.9.bias torch.Size([1])
-----------------------------------------------
prev_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_1_overlap.pth
... weight transfer
Model restored from checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_1_overlap.pth
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)487 len(self.masks)487
...start memory candidates collection
...end memory candidates collection :  587
...start memory list generation
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)299 len(self.masks)299
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setval
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modeval
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)57 len(self.masks)57
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settest
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)1449 len(self.masks)1449
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setmemory
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
memory json location
./datasets/data/swin_voc2012_best_15-1/memory.json
... memory list :  100 [17, 255, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)100 len(self.masks)100
Dataset: voc, Train set: 299, Val set: 57, Test set: 1449
... train epoch : 50 , iterations : 14950 , val_interval : 149
test ckpt_dir checkpoints/%s/%s_%s_%s_step_%d_overlap.pth
best_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_2_overlap.pth
color [128   0   0]
(18,)

Overall Acc: 0.963061
Mean Acc: 0.915571
FreqW Acc: 0.932627
Mean IoU: 0.832517
Mean IoU(per pixel): 0.928753
Class IoU/Acc/Recall:
\background: 0.9536 (miou) , 0.9757 (acc) , 0.9768 (rec) 
\aeroplane: 0.9099 (miou) , 0.9542 (acc) , 0.9515 (rec) 
\bicycle: 0.4287 (miou) , 0.9116 (acc) , 0.4473 (rec) 
\bird: 0.9473 (miou) , 0.9776 (acc) , 0.9683 (rec) 
\boat: 0.7721 (miou) , 0.9251 (acc) , 0.8237 (rec) 
\bottle: 0.8622 (miou) , 0.9555 (acc) , 0.8982 (rec) 
\bus: 0.9491 (miou) , 0.9771 (acc) , 0.9708 (rec) 
\car: 0.9011 (miou) , 0.9225 (acc) , 0.9750 (rec) 
\cat: 0.9621 (miou) , 0.9847 (acc) , 0.9767 (rec) 
\chair: 0.5529 (miou) , 0.6704 (acc) , 0.7592 (rec) 
\cow: 0.9415 (miou) , 0.9794 (acc) , 0.9605 (rec) 
\diningtable: 0.6669 (miou) , 0.7217 (acc) , 0.8979 (rec) 
\dog: 0.9446 (miou) , 0.9757 (acc) , 0.9674 (rec) 
\horse: 0.9236 (miou) , 0.9579 (acc) , 0.9627 (rec) 
\motorbike: 0.9237 (miou) , 0.9680 (acc) , 0.9528 (rec) 
\person: 0.8954 (miou) , 0.9287 (acc) , 0.9615 (rec) 
\pottedplant: 0.5843 (miou) , 0.7498 (acc) , 0.7259 (rec) 
\sheep: 0.8661 (miou) , 0.9448 (acc) , 0.9123 (rec) 

[0.9536470157724469, 0.9099308909237777, 0.42871042732365333, 0.9472976194401461, 0.7721378074291764, 0.8621552640359309, 0.9491419846254169, 0.9011255672220239, 0.9620793821655363, 0.5528578626489881, 0.941492143201481, 0.6669247440340959, 0.944581240572964, 0.9236419752468812, 0.9236872387355609, 0.8954350102126956]
13.534846173590775
16
...from 0 to 15 : best/test_before_mIoU : 0.845928
[0.5843410324720999, 0.8661224025629181]
...from 16 to 17 best/test_after_mIoU : 0.725232
...from 0 to 15 : best/test_before_acc : 0.924107
...from 16 to 17 best/test_after_acc : 0.847284
STEP: 3
opt.datasetvoc
lalallal
15-1
[1, 1, 15, 1, 1, 1]
curr_idx= [18, 19]
==============================================
  task : 15-1
  step : 3
  Device: cuda
  opts : 
Namespace(KDLoss=True, KDLoss_prelogit=True, amp=True, batch_size=1, bn_freeze=True, ckpt='checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_1_overlap.pth', conloss_proposal=True, conloss_prototype=True, crop_size=513, crop_val=True, curr_itrs=0, curr_step=3, data_root='/opt/data/private/zzk/dataset/VOCdevkit/VOC2012/', dataset='voc', device=device(type='cuda'), freeze=False, freeze_low=True, gpu_id='0', loss_tred=True, loss_type='bce_loss', lr=0.0001, lr_policy='poly', mem_size=100, merge_proposal_num=100, model='deeplabv3_swin_transformer', name='swin_voc2012_best', not_loss_proposal=False, num_classes=[1, 1, 15, 1, 1, 1], output_stride=16, overlap=True, prev_classes=19, print_interval=10, proposal_channel=100, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step='0,1,2,3,4,5', step_size=10000, sum_classes=18, task='15-1', test_only=True, test_val=False, train_epoch=50, unknown=True, unknown_cluster=1, val_batch_size=1, val_interval=100, w_transfer=True, weight_decay=0.0001)
==============================================
ModuleList(
  (0): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (1): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (2): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (3): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (4): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
)
optim_type:ADAMW
----------- trainable parameters --------------
backbone.model.patch_embed.proj.weight torch.Size([128, 3, 4, 4])
backbone.model.patch_embed.proj.bias torch.Size([128])
backbone.model.patch_embed.norm.weight torch.Size([128])
backbone.model.patch_embed.norm.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.0.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.0.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.0.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.0.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.0.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.0.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.0.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.0.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.0.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.1.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.1.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.1.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.1.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.1.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.1.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.1.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.1.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.downsample.reduction.weight torch.Size([256, 512])
backbone.model.layers.0.downsample.norm.weight torch.Size([512])
backbone.model.layers.0.downsample.norm.bias torch.Size([512])
backbone.model.layers.1.blocks.0.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.0.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.0.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.0.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.0.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.0.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.0.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.0.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.0.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.0.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.1.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.1.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.1.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.1.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.1.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.1.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.1.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.1.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.downsample.reduction.weight torch.Size([512, 1024])
backbone.model.layers.1.downsample.norm.weight torch.Size([1024])
backbone.model.layers.1.downsample.norm.bias torch.Size([1024])
backbone.model.layers.2.blocks.0.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.0.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.0.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.0.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.0.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.0.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.0.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.0.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.0.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.0.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.1.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.1.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.1.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.1.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.1.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.1.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.1.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.1.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.2.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.2.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.2.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.2.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.2.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.2.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.2.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.2.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.3.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.3.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.3.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.3.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.3.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.3.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.3.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.3.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.4.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.4.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.4.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.4.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.4.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.4.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.4.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.4.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.5.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.5.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.5.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.5.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.5.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.5.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.5.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.5.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.6.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.6.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.6.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.6.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.6.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.6.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.6.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.6.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.7.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.7.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.7.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.7.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.7.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.7.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.7.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.7.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.8.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.8.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.8.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.8.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.8.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.8.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.8.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.8.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.9.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.9.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.9.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.9.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.9.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.9.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.9.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.9.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.10.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.10.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.10.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.10.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.10.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.10.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.10.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.10.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.11.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.11.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.11.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.11.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.11.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.11.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.11.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.11.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.12.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.12.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.12.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.12.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.12.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.12.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.12.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.12.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.13.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.13.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.13.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.13.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.13.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.13.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.13.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.13.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.14.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.14.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.14.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.14.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.14.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.14.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.14.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.14.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.15.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.15.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.15.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.15.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.15.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.15.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.15.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.15.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.16.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.16.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.16.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.16.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.16.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.16.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.16.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.16.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.17.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.17.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.17.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.17.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.17.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.17.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.17.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.17.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.downsample.reduction.weight torch.Size([1024, 2048])
backbone.model.layers.2.downsample.norm.weight torch.Size([2048])
backbone.model.layers.2.downsample.norm.bias torch.Size([2048])
backbone.model.layers.3.blocks.0.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.0.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.0.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.0.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.0.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.0.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.0.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.0.mlp.fc2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.1.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.1.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.1.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.1.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.1.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.1.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.1.mlp.fc2.bias torch.Size([1024])
backbone.model.norm0.weight torch.Size([128])
backbone.model.norm0.bias torch.Size([128])
backbone.model.norm1.weight torch.Size([256])
backbone.model.norm1.bias torch.Size([256])
backbone.model.norm2.weight torch.Size([512])
backbone.model.norm2.bias torch.Size([512])
backbone.model.norm3.weight torch.Size([1024])
backbone.model.norm3.bias torch.Size([1024])
classifier.aspp.convs.0.0.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.0.1.weight torch.Size([256])
classifier.aspp.convs.0.1.bias torch.Size([256])
classifier.aspp.convs.1.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.1.1.weight torch.Size([256])
classifier.aspp.convs.1.1.bias torch.Size([256])
classifier.aspp.convs.2.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.2.1.weight torch.Size([256])
classifier.aspp.convs.2.1.bias torch.Size([256])
classifier.aspp.convs.3.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.3.1.weight torch.Size([256])
classifier.aspp.convs.3.1.bias torch.Size([256])
classifier.aspp.convs.4.1.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.4.2.weight torch.Size([256])
classifier.aspp.convs.4.2.bias torch.Size([256])
classifier.aspp.project.0.weight torch.Size([256, 1280, 1, 1])
classifier.aspp.project.1.weight torch.Size([256])
classifier.aspp.project.1.bias torch.Size([256])
classifier.head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.head.0.1.weight torch.Size([256])
classifier.head.0.1.bias torch.Size([256])
classifier.head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.head.1.1.weight torch.Size([256])
classifier.head.1.1.bias torch.Size([256])
classifier.head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.head.2.1.weight torch.Size([256])
classifier.head.2.1.bias torch.Size([256])
classifier.head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.head.3.1.weight torch.Size([256])
classifier.head.3.1.bias torch.Size([256])
classifier.head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.head.4.1.weight torch.Size([256])
classifier.head.4.1.bias torch.Size([256])
classifier.head.5.0.weight torch.Size([256, 256, 3, 3])
classifier.head.5.1.weight torch.Size([256])
classifier.head.5.1.bias torch.Size([256])
classifier.head2.0.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.0.0.bias torch.Size([1])
classifier.head2.1.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.1.0.bias torch.Size([1])
classifier.head2.2.0.weight torch.Size([15, 256, 1, 1])
classifier.head2.2.0.bias torch.Size([15])
classifier.head2.3.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.3.0.bias torch.Size([1])
classifier.head2.4.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.4.0.bias torch.Size([1])
classifier.head2.5.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.5.0.bias torch.Size([1])
classifier.proposal_head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.1.weight torch.Size([256])
classifier.proposal_head.0.1.bias torch.Size([256])
classifier.proposal_head.0.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.4.weight torch.Size([256])
classifier.proposal_head.0.4.bias torch.Size([256])
classifier.proposal_head.0.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.7.weight torch.Size([256])
classifier.proposal_head.0.7.bias torch.Size([256])
classifier.proposal_head.0.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.0.9.bias torch.Size([1])
classifier.proposal_head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.1.weight torch.Size([256])
classifier.proposal_head.1.1.bias torch.Size([256])
classifier.proposal_head.1.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.4.weight torch.Size([256])
classifier.proposal_head.1.4.bias torch.Size([256])
classifier.proposal_head.1.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.7.weight torch.Size([256])
classifier.proposal_head.1.7.bias torch.Size([256])
classifier.proposal_head.1.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.1.9.bias torch.Size([1])
classifier.proposal_head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.1.weight torch.Size([256])
classifier.proposal_head.2.1.bias torch.Size([256])
classifier.proposal_head.2.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.4.weight torch.Size([256])
classifier.proposal_head.2.4.bias torch.Size([256])
classifier.proposal_head.2.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.7.weight torch.Size([256])
classifier.proposal_head.2.7.bias torch.Size([256])
classifier.proposal_head.2.9.weight torch.Size([15, 256, 1, 1])
classifier.proposal_head.2.9.bias torch.Size([15])
classifier.proposal_head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.1.weight torch.Size([256])
classifier.proposal_head.3.1.bias torch.Size([256])
classifier.proposal_head.3.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.4.weight torch.Size([256])
classifier.proposal_head.3.4.bias torch.Size([256])
classifier.proposal_head.3.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.7.weight torch.Size([256])
classifier.proposal_head.3.7.bias torch.Size([256])
classifier.proposal_head.3.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.3.9.bias torch.Size([1])
classifier.proposal_head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.1.weight torch.Size([256])
classifier.proposal_head.4.1.bias torch.Size([256])
classifier.proposal_head.4.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.4.weight torch.Size([256])
classifier.proposal_head.4.4.bias torch.Size([256])
classifier.proposal_head.4.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.7.weight torch.Size([256])
classifier.proposal_head.4.7.bias torch.Size([256])
classifier.proposal_head.4.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.4.9.bias torch.Size([1])
classifier.proposal_head.5.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.1.weight torch.Size([256])
classifier.proposal_head.5.1.bias torch.Size([256])
classifier.proposal_head.5.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.4.weight torch.Size([256])
classifier.proposal_head.5.4.bias torch.Size([256])
classifier.proposal_head.5.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.7.weight torch.Size([256])
classifier.proposal_head.5.7.bias torch.Size([256])
classifier.proposal_head.5.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.5.9.bias torch.Size([1])
-----------------------------------------------
prev_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_2_overlap.pth
... weight transfer
Model restored from checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_2_overlap.pth
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)299 len(self.masks)299
...start memory candidates collection
...end memory candidates collection :  399
...start memory list generation
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)491 len(self.masks)491
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setval
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modeval
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)90 len(self.masks)90
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settest
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)1449 len(self.masks)1449
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setmemory
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
memory json location
./datasets/data/swin_voc2012_best_15-1/memory.json
... memory list :  100 [18, 255, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)100 len(self.masks)100
Dataset: voc, Train set: 491, Val set: 90, Test set: 1449
... train epoch : 50 , iterations : 24550 , val_interval : 245
test ckpt_dir checkpoints/%s/%s_%s_%s_step_%d_overlap.pth
best_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_3_overlap.pth
color [128   0   0]
(19,)

Overall Acc: 0.939056
Mean Acc: 0.906085
FreqW Acc: 0.902000
Mean IoU: 0.801363
Mean IoU(per pixel): 0.885113
Class IoU/Acc/Recall:
\background: 0.9237 (miou) , 0.9451 (acc) , 0.9761 (rec) 
\aeroplane: 0.9081 (miou) , 0.9533 (acc) , 0.9504 (rec) 
\bicycle: 0.4266 (miou) , 0.8792 (acc) , 0.4531 (rec) 
\bird: 0.9501 (miou) , 0.9741 (acc) , 0.9747 (rec) 
\boat: 0.7531 (miou) , 0.9013 (acc) , 0.8208 (rec) 
\bottle: 0.8618 (miou) , 0.9583 (acc) , 0.8954 (rec) 
\bus: 0.9509 (miou) , 0.9768 (acc) , 0.9728 (rec) 
\car: 0.9011 (miou) , 0.9236 (acc) , 0.9737 (rec) 
\cat: 0.9630 (miou) , 0.9825 (acc) , 0.9798 (rec) 
\chair: 0.5147 (miou) , 0.6038 (acc) , 0.7771 (rec) 
\cow: 0.9454 (miou) , 0.9786 (acc) , 0.9653 (rec) 
\diningtable: 0.6591 (miou) , 0.7087 (acc) , 0.9041 (rec) 
\dog: 0.9427 (miou) , 0.9719 (acc) , 0.9692 (rec) 
\horse: 0.9221 (miou) , 0.9584 (acc) , 0.9605 (rec) 
\motorbike: 0.9206 (miou) , 0.9696 (acc) , 0.9480 (rec) 
\person: 0.8985 (miou) , 0.9266 (acc) , 0.9673 (rec) 
\pottedplant: 0.5719 (miou) , 0.7708 (acc) , 0.6890 (rec) 
\sheep: 0.8825 (miou) , 0.9523 (acc) , 0.9233 (rec) 
\sofa: 0.3301 (miou) , 0.8807 (acc) , 0.3455 (rec) 

[0.9237353160208996, 0.9081322345840229, 0.4265660049017791, 0.9501033515463404, 0.7531278959175145, 0.8617693951399886, 0.9508790809825879, 0.90109787199151, 0.9629691233761151, 0.5146944643747249, 0.9453789624084611, 0.6591180085083616, 0.9427355587542365, 0.9220895450487341, 0.9206071553411036, 0.898483145113242]
13.441487114009622
16
...from 0 to 15 : best/test_before_mIoU : 0.840093
[0.5718628007941016, 0.882458293533309, 0.3300946829167255]
...from 16 to 18 best/test_after_mIoU : 0.594805
...from 0 to 15 : best/test_before_acc : 0.913238
...from 16 to 18 best/test_after_acc : 0.867933
STEP: 4
opt.datasetvoc
lalallal
15-1
[1, 1, 15, 1, 1, 1, 1]
curr_idx= [19, 20]
==============================================
  task : 15-1
  step : 4
  Device: cuda
  opts : 
Namespace(KDLoss=True, KDLoss_prelogit=True, amp=True, batch_size=1, bn_freeze=True, ckpt='checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_2_overlap.pth', conloss_proposal=True, conloss_prototype=True, crop_size=513, crop_val=True, curr_itrs=0, curr_step=4, data_root='/opt/data/private/zzk/dataset/VOCdevkit/VOC2012/', dataset='voc', device=device(type='cuda'), freeze=False, freeze_low=True, gpu_id='0', loss_tred=True, loss_type='bce_loss', lr=0.0001, lr_policy='poly', mem_size=100, merge_proposal_num=100, model='deeplabv3_swin_transformer', name='swin_voc2012_best', not_loss_proposal=False, num_classes=[1, 1, 15, 1, 1, 1, 1], output_stride=16, overlap=True, prev_classes=20, print_interval=10, proposal_channel=100, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step='0,1,2,3,4,5', step_size=10000, sum_classes=19, task='15-1', test_only=True, test_val=False, train_epoch=50, unknown=True, unknown_cluster=1, val_batch_size=1, val_interval=100, w_transfer=True, weight_decay=0.0001)
==============================================
ModuleList(
  (0): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (1): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (2): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (3): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (4): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (6): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
)
optim_type:ADAMW
----------- trainable parameters --------------
backbone.model.patch_embed.proj.weight torch.Size([128, 3, 4, 4])
backbone.model.patch_embed.proj.bias torch.Size([128])
backbone.model.patch_embed.norm.weight torch.Size([128])
backbone.model.patch_embed.norm.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.0.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.0.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.0.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.0.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.0.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.0.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.0.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.0.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.0.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.1.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.1.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.1.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.1.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.1.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.1.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.1.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.1.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.downsample.reduction.weight torch.Size([256, 512])
backbone.model.layers.0.downsample.norm.weight torch.Size([512])
backbone.model.layers.0.downsample.norm.bias torch.Size([512])
backbone.model.layers.1.blocks.0.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.0.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.0.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.0.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.0.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.0.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.0.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.0.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.0.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.0.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.1.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.1.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.1.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.1.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.1.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.1.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.1.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.1.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.downsample.reduction.weight torch.Size([512, 1024])
backbone.model.layers.1.downsample.norm.weight torch.Size([1024])
backbone.model.layers.1.downsample.norm.bias torch.Size([1024])
backbone.model.layers.2.blocks.0.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.0.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.0.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.0.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.0.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.0.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.0.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.0.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.0.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.0.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.1.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.1.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.1.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.1.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.1.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.1.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.1.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.1.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.2.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.2.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.2.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.2.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.2.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.2.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.2.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.2.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.3.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.3.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.3.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.3.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.3.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.3.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.3.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.3.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.4.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.4.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.4.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.4.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.4.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.4.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.4.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.4.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.5.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.5.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.5.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.5.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.5.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.5.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.5.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.5.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.6.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.6.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.6.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.6.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.6.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.6.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.6.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.6.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.7.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.7.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.7.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.7.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.7.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.7.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.7.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.7.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.8.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.8.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.8.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.8.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.8.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.8.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.8.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.8.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.9.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.9.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.9.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.9.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.9.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.9.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.9.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.9.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.10.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.10.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.10.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.10.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.10.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.10.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.10.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.10.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.11.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.11.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.11.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.11.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.11.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.11.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.11.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.11.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.12.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.12.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.12.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.12.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.12.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.12.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.12.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.12.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.13.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.13.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.13.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.13.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.13.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.13.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.13.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.13.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.14.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.14.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.14.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.14.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.14.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.14.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.14.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.14.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.15.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.15.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.15.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.15.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.15.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.15.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.15.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.15.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.16.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.16.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.16.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.16.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.16.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.16.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.16.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.16.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.17.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.17.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.17.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.17.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.17.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.17.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.17.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.17.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.downsample.reduction.weight torch.Size([1024, 2048])
backbone.model.layers.2.downsample.norm.weight torch.Size([2048])
backbone.model.layers.2.downsample.norm.bias torch.Size([2048])
backbone.model.layers.3.blocks.0.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.0.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.0.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.0.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.0.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.0.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.0.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.0.mlp.fc2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.1.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.1.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.1.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.1.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.1.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.1.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.1.mlp.fc2.bias torch.Size([1024])
backbone.model.norm0.weight torch.Size([128])
backbone.model.norm0.bias torch.Size([128])
backbone.model.norm1.weight torch.Size([256])
backbone.model.norm1.bias torch.Size([256])
backbone.model.norm2.weight torch.Size([512])
backbone.model.norm2.bias torch.Size([512])
backbone.model.norm3.weight torch.Size([1024])
backbone.model.norm3.bias torch.Size([1024])
classifier.aspp.convs.0.0.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.0.1.weight torch.Size([256])
classifier.aspp.convs.0.1.bias torch.Size([256])
classifier.aspp.convs.1.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.1.1.weight torch.Size([256])
classifier.aspp.convs.1.1.bias torch.Size([256])
classifier.aspp.convs.2.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.2.1.weight torch.Size([256])
classifier.aspp.convs.2.1.bias torch.Size([256])
classifier.aspp.convs.3.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.3.1.weight torch.Size([256])
classifier.aspp.convs.3.1.bias torch.Size([256])
classifier.aspp.convs.4.1.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.4.2.weight torch.Size([256])
classifier.aspp.convs.4.2.bias torch.Size([256])
classifier.aspp.project.0.weight torch.Size([256, 1280, 1, 1])
classifier.aspp.project.1.weight torch.Size([256])
classifier.aspp.project.1.bias torch.Size([256])
classifier.head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.head.0.1.weight torch.Size([256])
classifier.head.0.1.bias torch.Size([256])
classifier.head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.head.1.1.weight torch.Size([256])
classifier.head.1.1.bias torch.Size([256])
classifier.head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.head.2.1.weight torch.Size([256])
classifier.head.2.1.bias torch.Size([256])
classifier.head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.head.3.1.weight torch.Size([256])
classifier.head.3.1.bias torch.Size([256])
classifier.head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.head.4.1.weight torch.Size([256])
classifier.head.4.1.bias torch.Size([256])
classifier.head.5.0.weight torch.Size([256, 256, 3, 3])
classifier.head.5.1.weight torch.Size([256])
classifier.head.5.1.bias torch.Size([256])
classifier.head.6.0.weight torch.Size([256, 256, 3, 3])
classifier.head.6.1.weight torch.Size([256])
classifier.head.6.1.bias torch.Size([256])
classifier.head2.0.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.0.0.bias torch.Size([1])
classifier.head2.1.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.1.0.bias torch.Size([1])
classifier.head2.2.0.weight torch.Size([15, 256, 1, 1])
classifier.head2.2.0.bias torch.Size([15])
classifier.head2.3.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.3.0.bias torch.Size([1])
classifier.head2.4.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.4.0.bias torch.Size([1])
classifier.head2.5.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.5.0.bias torch.Size([1])
classifier.head2.6.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.6.0.bias torch.Size([1])
classifier.proposal_head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.1.weight torch.Size([256])
classifier.proposal_head.0.1.bias torch.Size([256])
classifier.proposal_head.0.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.4.weight torch.Size([256])
classifier.proposal_head.0.4.bias torch.Size([256])
classifier.proposal_head.0.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.7.weight torch.Size([256])
classifier.proposal_head.0.7.bias torch.Size([256])
classifier.proposal_head.0.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.0.9.bias torch.Size([1])
classifier.proposal_head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.1.weight torch.Size([256])
classifier.proposal_head.1.1.bias torch.Size([256])
classifier.proposal_head.1.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.4.weight torch.Size([256])
classifier.proposal_head.1.4.bias torch.Size([256])
classifier.proposal_head.1.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.7.weight torch.Size([256])
classifier.proposal_head.1.7.bias torch.Size([256])
classifier.proposal_head.1.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.1.9.bias torch.Size([1])
classifier.proposal_head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.1.weight torch.Size([256])
classifier.proposal_head.2.1.bias torch.Size([256])
classifier.proposal_head.2.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.4.weight torch.Size([256])
classifier.proposal_head.2.4.bias torch.Size([256])
classifier.proposal_head.2.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.7.weight torch.Size([256])
classifier.proposal_head.2.7.bias torch.Size([256])
classifier.proposal_head.2.9.weight torch.Size([15, 256, 1, 1])
classifier.proposal_head.2.9.bias torch.Size([15])
classifier.proposal_head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.1.weight torch.Size([256])
classifier.proposal_head.3.1.bias torch.Size([256])
classifier.proposal_head.3.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.4.weight torch.Size([256])
classifier.proposal_head.3.4.bias torch.Size([256])
classifier.proposal_head.3.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.7.weight torch.Size([256])
classifier.proposal_head.3.7.bias torch.Size([256])
classifier.proposal_head.3.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.3.9.bias torch.Size([1])
classifier.proposal_head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.1.weight torch.Size([256])
classifier.proposal_head.4.1.bias torch.Size([256])
classifier.proposal_head.4.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.4.weight torch.Size([256])
classifier.proposal_head.4.4.bias torch.Size([256])
classifier.proposal_head.4.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.7.weight torch.Size([256])
classifier.proposal_head.4.7.bias torch.Size([256])
classifier.proposal_head.4.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.4.9.bias torch.Size([1])
classifier.proposal_head.5.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.1.weight torch.Size([256])
classifier.proposal_head.5.1.bias torch.Size([256])
classifier.proposal_head.5.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.4.weight torch.Size([256])
classifier.proposal_head.5.4.bias torch.Size([256])
classifier.proposal_head.5.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.7.weight torch.Size([256])
classifier.proposal_head.5.7.bias torch.Size([256])
classifier.proposal_head.5.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.5.9.bias torch.Size([1])
classifier.proposal_head.6.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.6.1.weight torch.Size([256])
classifier.proposal_head.6.1.bias torch.Size([256])
classifier.proposal_head.6.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.6.4.weight torch.Size([256])
classifier.proposal_head.6.4.bias torch.Size([256])
classifier.proposal_head.6.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.6.7.weight torch.Size([256])
classifier.proposal_head.6.7.bias torch.Size([256])
classifier.proposal_head.6.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.6.9.bias torch.Size([1])
-----------------------------------------------
prev_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_3_overlap.pth
... weight transfer
Model restored from checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_3_overlap.pth
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)491 len(self.masks)491
...start memory candidates collection
...end memory candidates collection :  591
...start memory list generation
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)500 len(self.masks)500
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setval
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modeval
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)84 len(self.masks)84
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settest
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)1449 len(self.masks)1449
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setmemory
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
memory json location
./datasets/data/swin_voc2012_best_15-1/memory.json
... memory list :  100 [19, 255, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)100 len(self.masks)100
Dataset: voc, Train set: 500, Val set: 84, Test set: 1449
... train epoch : 50 , iterations : 25000 , val_interval : 250
test ckpt_dir checkpoints/%s/%s_%s_%s_step_%d_overlap.pth
best_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_4_overlap.pth
color [128   0   0]
(20,)

Overall Acc: 0.932895
Mean Acc: 0.915153
FreqW Acc: 0.894107
Mean IoU: 0.801282
Mean IoU(per pixel): 0.874229
Class IoU/Acc/Recall:
\background: 0.9151 (miou) , 0.9334 (acc) , 0.9790 (rec) 
\aeroplane: 0.9104 (miou) , 0.9564 (acc) , 0.9499 (rec) 
\bicycle: 0.4288 (miou) , 0.9073 (acc) , 0.4485 (rec) 
\bird: 0.9546 (miou) , 0.9751 (acc) , 0.9785 (rec) 
\boat: 0.7651 (miou) , 0.9249 (acc) , 0.8158 (rec) 
\bottle: 0.8652 (miou) , 0.9629 (acc) , 0.8950 (rec) 
\bus: 0.9481 (miou) , 0.9739 (acc) , 0.9728 (rec) 
\car: 0.9081 (miou) , 0.9433 (acc) , 0.9605 (rec) 
\cat: 0.9607 (miou) , 0.9854 (acc) , 0.9746 (rec) 
\chair: 0.5301 (miou) , 0.6457 (acc) , 0.7475 (rec) 
\cow: 0.9455 (miou) , 0.9768 (acc) , 0.9672 (rec) 
\diningtable: 0.6620 (miou) , 0.7186 (acc) , 0.8937 (rec) 
\dog: 0.9454 (miou) , 0.9763 (acc) , 0.9676 (rec) 
\horse: 0.9226 (miou) , 0.9591 (acc) , 0.9603 (rec) 
\motorbike: 0.9146 (miou) , 0.9710 (acc) , 0.9403 (rec) 
\person: 0.8992 (miou) , 0.9322 (acc) , 0.9622 (rec) 
\pottedplant: 0.5583 (miou) , 0.7805 (acc) , 0.6623 (rec) 
\sheep: 0.8784 (miou) , 0.9480 (acc) , 0.9228 (rec) 
\sofa: 0.2961 (miou) , 0.8717 (acc) , 0.3096 (rec) 
\train: 0.8174 (miou) , 0.9607 (acc) , 0.8457 (rec) 

[0.9150614247307919, 0.9104281700865329, 0.428798213637268, 0.9546445130462837, 0.7650612524083403, 0.8652421177868028, 0.9481064152610801, 0.9080578933295078, 0.9606715730233912, 0.5300953588119588, 0.9455320202422387, 0.6620202443405929, 0.9453537772356891, 0.9225589292596285, 0.9146013345627029, 0.8991941827978854]
13.475427420560695
16
...from 0 to 15 : best/test_before_mIoU : 0.842214
[0.5583164925407267, 0.8783950583007001, 0.2961046691584676, 0.8173979611024049]
...from 16 to 19 best/test_after_mIoU : 0.637554
...from 0 to 15 : best/test_before_acc : 0.921383
...from 16 to 19 best/test_after_acc : 0.890236
STEP: 5
opt.datasetvoc
lalallal
15-1
[1, 1, 15, 1, 1, 1, 1, 1]
curr_idx= [20, 21]
==============================================
  task : 15-1
  step : 5
  Device: cuda
  opts : 
Namespace(KDLoss=True, KDLoss_prelogit=True, amp=True, batch_size=1, bn_freeze=True, ckpt='checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_3_overlap.pth', conloss_proposal=True, conloss_prototype=True, crop_size=513, crop_val=True, curr_itrs=0, curr_step=5, data_root='/opt/data/private/zzk/dataset/VOCdevkit/VOC2012/', dataset='voc', device=device(type='cuda'), freeze=False, freeze_low=True, gpu_id='0', loss_tred=True, loss_type='bce_loss', lr=0.0001, lr_policy='poly', mem_size=100, merge_proposal_num=100, model='deeplabv3_swin_transformer', name='swin_voc2012_best', not_loss_proposal=False, num_classes=[1, 1, 15, 1, 1, 1, 1, 1], output_stride=16, overlap=True, prev_classes=21, print_interval=10, proposal_channel=100, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step='0,1,2,3,4,5', step_size=10000, sum_classes=20, task='15-1', test_only=True, test_val=False, train_epoch=50, unknown=True, unknown_cluster=1, val_batch_size=1, val_interval=100, w_transfer=True, weight_decay=0.0001)
==============================================
ModuleList(
  (0): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (1): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (2): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (3): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (4): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (6): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
  (7): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
  )
)
optim_type:ADAMW
----------- trainable parameters --------------
backbone.model.patch_embed.proj.weight torch.Size([128, 3, 4, 4])
backbone.model.patch_embed.proj.bias torch.Size([128])
backbone.model.patch_embed.norm.weight torch.Size([128])
backbone.model.patch_embed.norm.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.0.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.0.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.0.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.0.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.0.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.0.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.0.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.0.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.0.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.0.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm1.bias torch.Size([128])
backbone.model.layers.0.blocks.1.attn.relative_position_bias_table torch.Size([529, 4])
backbone.model.layers.0.blocks.1.attn.qkv.weight torch.Size([384, 128])
backbone.model.layers.0.blocks.1.attn.qkv.bias torch.Size([384])
backbone.model.layers.0.blocks.1.attn.proj.weight torch.Size([128, 128])
backbone.model.layers.0.blocks.1.attn.proj.bias torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.weight torch.Size([128])
backbone.model.layers.0.blocks.1.norm2.bias torch.Size([128])
backbone.model.layers.0.blocks.1.mlp.fc1.weight torch.Size([512, 128])
backbone.model.layers.0.blocks.1.mlp.fc1.bias torch.Size([512])
backbone.model.layers.0.blocks.1.mlp.fc2.weight torch.Size([128, 512])
backbone.model.layers.0.blocks.1.mlp.fc2.bias torch.Size([128])
backbone.model.layers.0.downsample.reduction.weight torch.Size([256, 512])
backbone.model.layers.0.downsample.norm.weight torch.Size([512])
backbone.model.layers.0.downsample.norm.bias torch.Size([512])
backbone.model.layers.1.blocks.0.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.0.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.0.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.0.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.0.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.0.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.0.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.0.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.0.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.0.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.0.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm1.bias torch.Size([256])
backbone.model.layers.1.blocks.1.attn.relative_position_bias_table torch.Size([529, 8])
backbone.model.layers.1.blocks.1.attn.qkv.weight torch.Size([768, 256])
backbone.model.layers.1.blocks.1.attn.qkv.bias torch.Size([768])
backbone.model.layers.1.blocks.1.attn.proj.weight torch.Size([256, 256])
backbone.model.layers.1.blocks.1.attn.proj.bias torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.weight torch.Size([256])
backbone.model.layers.1.blocks.1.norm2.bias torch.Size([256])
backbone.model.layers.1.blocks.1.mlp.fc1.weight torch.Size([1024, 256])
backbone.model.layers.1.blocks.1.mlp.fc1.bias torch.Size([1024])
backbone.model.layers.1.blocks.1.mlp.fc2.weight torch.Size([256, 1024])
backbone.model.layers.1.blocks.1.mlp.fc2.bias torch.Size([256])
backbone.model.layers.1.downsample.reduction.weight torch.Size([512, 1024])
backbone.model.layers.1.downsample.norm.weight torch.Size([1024])
backbone.model.layers.1.downsample.norm.bias torch.Size([1024])
backbone.model.layers.2.blocks.0.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.0.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.0.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.0.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.0.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.0.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.0.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.0.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.0.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.0.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.0.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.1.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.1.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.1.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.1.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.1.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.1.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.1.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.1.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.1.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.1.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.2.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.2.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.2.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.2.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.2.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.2.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.2.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.2.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.2.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.2.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.3.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.3.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.3.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.3.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.3.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.3.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.3.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.3.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.3.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.3.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.4.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.4.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.4.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.4.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.4.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.4.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.4.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.4.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.4.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.4.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.5.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.5.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.5.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.5.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.5.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.5.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.5.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.5.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.5.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.5.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.6.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.6.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.6.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.6.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.6.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.6.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.6.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.6.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.6.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.6.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.7.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.7.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.7.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.7.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.7.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.7.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.7.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.7.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.7.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.7.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.8.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.8.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.8.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.8.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.8.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.8.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.8.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.8.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.8.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.8.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.9.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.9.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.9.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.9.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.9.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.9.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.9.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.9.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.9.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.9.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.10.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.10.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.10.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.10.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.10.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.10.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.10.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.10.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.10.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.10.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.11.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.11.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.11.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.11.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.11.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.11.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.11.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.11.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.11.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.11.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.12.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.12.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.12.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.12.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.12.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.12.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.12.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.12.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.12.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.12.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.13.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.13.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.13.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.13.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.13.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.13.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.13.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.13.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.13.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.13.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.14.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.14.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.14.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.14.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.14.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.14.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.14.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.14.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.14.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.14.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.15.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.15.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.15.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.15.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.15.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.15.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.15.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.15.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.15.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.15.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.16.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.16.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.16.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.16.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.16.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.16.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.16.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.16.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.16.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.16.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm1.bias torch.Size([512])
backbone.model.layers.2.blocks.17.attn.relative_position_bias_table torch.Size([529, 16])
backbone.model.layers.2.blocks.17.attn.qkv.weight torch.Size([1536, 512])
backbone.model.layers.2.blocks.17.attn.qkv.bias torch.Size([1536])
backbone.model.layers.2.blocks.17.attn.proj.weight torch.Size([512, 512])
backbone.model.layers.2.blocks.17.attn.proj.bias torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.weight torch.Size([512])
backbone.model.layers.2.blocks.17.norm2.bias torch.Size([512])
backbone.model.layers.2.blocks.17.mlp.fc1.weight torch.Size([2048, 512])
backbone.model.layers.2.blocks.17.mlp.fc1.bias torch.Size([2048])
backbone.model.layers.2.blocks.17.mlp.fc2.weight torch.Size([512, 2048])
backbone.model.layers.2.blocks.17.mlp.fc2.bias torch.Size([512])
backbone.model.layers.2.downsample.reduction.weight torch.Size([1024, 2048])
backbone.model.layers.2.downsample.norm.weight torch.Size([2048])
backbone.model.layers.2.downsample.norm.bias torch.Size([2048])
backbone.model.layers.3.blocks.0.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.0.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.0.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.0.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.0.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.0.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.0.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.0.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.0.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.0.mlp.fc2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm1.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.attn.relative_position_bias_table torch.Size([529, 32])
backbone.model.layers.3.blocks.1.attn.qkv.weight torch.Size([3072, 1024])
backbone.model.layers.3.blocks.1.attn.qkv.bias torch.Size([3072])
backbone.model.layers.3.blocks.1.attn.proj.weight torch.Size([1024, 1024])
backbone.model.layers.3.blocks.1.attn.proj.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.weight torch.Size([1024])
backbone.model.layers.3.blocks.1.norm2.bias torch.Size([1024])
backbone.model.layers.3.blocks.1.mlp.fc1.weight torch.Size([4096, 1024])
backbone.model.layers.3.blocks.1.mlp.fc1.bias torch.Size([4096])
backbone.model.layers.3.blocks.1.mlp.fc2.weight torch.Size([1024, 4096])
backbone.model.layers.3.blocks.1.mlp.fc2.bias torch.Size([1024])
backbone.model.norm0.weight torch.Size([128])
backbone.model.norm0.bias torch.Size([128])
backbone.model.norm1.weight torch.Size([256])
backbone.model.norm1.bias torch.Size([256])
backbone.model.norm2.weight torch.Size([512])
backbone.model.norm2.bias torch.Size([512])
backbone.model.norm3.weight torch.Size([1024])
backbone.model.norm3.bias torch.Size([1024])
classifier.aspp.convs.0.0.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.0.1.weight torch.Size([256])
classifier.aspp.convs.0.1.bias torch.Size([256])
classifier.aspp.convs.1.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.1.1.weight torch.Size([256])
classifier.aspp.convs.1.1.bias torch.Size([256])
classifier.aspp.convs.2.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.2.1.weight torch.Size([256])
classifier.aspp.convs.2.1.bias torch.Size([256])
classifier.aspp.convs.3.0.weight torch.Size([256, 1024, 3, 3])
classifier.aspp.convs.3.1.weight torch.Size([256])
classifier.aspp.convs.3.1.bias torch.Size([256])
classifier.aspp.convs.4.1.weight torch.Size([256, 1024, 1, 1])
classifier.aspp.convs.4.2.weight torch.Size([256])
classifier.aspp.convs.4.2.bias torch.Size([256])
classifier.aspp.project.0.weight torch.Size([256, 1280, 1, 1])
classifier.aspp.project.1.weight torch.Size([256])
classifier.aspp.project.1.bias torch.Size([256])
classifier.head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.head.0.1.weight torch.Size([256])
classifier.head.0.1.bias torch.Size([256])
classifier.head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.head.1.1.weight torch.Size([256])
classifier.head.1.1.bias torch.Size([256])
classifier.head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.head.2.1.weight torch.Size([256])
classifier.head.2.1.bias torch.Size([256])
classifier.head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.head.3.1.weight torch.Size([256])
classifier.head.3.1.bias torch.Size([256])
classifier.head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.head.4.1.weight torch.Size([256])
classifier.head.4.1.bias torch.Size([256])
classifier.head.5.0.weight torch.Size([256, 256, 3, 3])
classifier.head.5.1.weight torch.Size([256])
classifier.head.5.1.bias torch.Size([256])
classifier.head.6.0.weight torch.Size([256, 256, 3, 3])
classifier.head.6.1.weight torch.Size([256])
classifier.head.6.1.bias torch.Size([256])
classifier.head.7.0.weight torch.Size([256, 256, 3, 3])
classifier.head.7.1.weight torch.Size([256])
classifier.head.7.1.bias torch.Size([256])
classifier.head2.0.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.0.0.bias torch.Size([1])
classifier.head2.1.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.1.0.bias torch.Size([1])
classifier.head2.2.0.weight torch.Size([15, 256, 1, 1])
classifier.head2.2.0.bias torch.Size([15])
classifier.head2.3.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.3.0.bias torch.Size([1])
classifier.head2.4.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.4.0.bias torch.Size([1])
classifier.head2.5.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.5.0.bias torch.Size([1])
classifier.head2.6.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.6.0.bias torch.Size([1])
classifier.head2.7.0.weight torch.Size([1, 256, 1, 1])
classifier.head2.7.0.bias torch.Size([1])
classifier.proposal_head.0.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.1.weight torch.Size([256])
classifier.proposal_head.0.1.bias torch.Size([256])
classifier.proposal_head.0.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.4.weight torch.Size([256])
classifier.proposal_head.0.4.bias torch.Size([256])
classifier.proposal_head.0.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.0.7.weight torch.Size([256])
classifier.proposal_head.0.7.bias torch.Size([256])
classifier.proposal_head.0.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.0.9.bias torch.Size([1])
classifier.proposal_head.1.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.1.weight torch.Size([256])
classifier.proposal_head.1.1.bias torch.Size([256])
classifier.proposal_head.1.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.4.weight torch.Size([256])
classifier.proposal_head.1.4.bias torch.Size([256])
classifier.proposal_head.1.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.1.7.weight torch.Size([256])
classifier.proposal_head.1.7.bias torch.Size([256])
classifier.proposal_head.1.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.1.9.bias torch.Size([1])
classifier.proposal_head.2.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.1.weight torch.Size([256])
classifier.proposal_head.2.1.bias torch.Size([256])
classifier.proposal_head.2.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.4.weight torch.Size([256])
classifier.proposal_head.2.4.bias torch.Size([256])
classifier.proposal_head.2.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.2.7.weight torch.Size([256])
classifier.proposal_head.2.7.bias torch.Size([256])
classifier.proposal_head.2.9.weight torch.Size([15, 256, 1, 1])
classifier.proposal_head.2.9.bias torch.Size([15])
classifier.proposal_head.3.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.1.weight torch.Size([256])
classifier.proposal_head.3.1.bias torch.Size([256])
classifier.proposal_head.3.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.4.weight torch.Size([256])
classifier.proposal_head.3.4.bias torch.Size([256])
classifier.proposal_head.3.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.3.7.weight torch.Size([256])
classifier.proposal_head.3.7.bias torch.Size([256])
classifier.proposal_head.3.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.3.9.bias torch.Size([1])
classifier.proposal_head.4.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.1.weight torch.Size([256])
classifier.proposal_head.4.1.bias torch.Size([256])
classifier.proposal_head.4.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.4.weight torch.Size([256])
classifier.proposal_head.4.4.bias torch.Size([256])
classifier.proposal_head.4.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.4.7.weight torch.Size([256])
classifier.proposal_head.4.7.bias torch.Size([256])
classifier.proposal_head.4.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.4.9.bias torch.Size([1])
classifier.proposal_head.5.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.1.weight torch.Size([256])
classifier.proposal_head.5.1.bias torch.Size([256])
classifier.proposal_head.5.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.4.weight torch.Size([256])
classifier.proposal_head.5.4.bias torch.Size([256])
classifier.proposal_head.5.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.5.7.weight torch.Size([256])
classifier.proposal_head.5.7.bias torch.Size([256])
classifier.proposal_head.5.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.5.9.bias torch.Size([1])
classifier.proposal_head.6.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.6.1.weight torch.Size([256])
classifier.proposal_head.6.1.bias torch.Size([256])
classifier.proposal_head.6.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.6.4.weight torch.Size([256])
classifier.proposal_head.6.4.bias torch.Size([256])
classifier.proposal_head.6.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.6.7.weight torch.Size([256])
classifier.proposal_head.6.7.bias torch.Size([256])
classifier.proposal_head.6.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.6.9.bias torch.Size([1])
classifier.proposal_head.7.0.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.7.1.weight torch.Size([256])
classifier.proposal_head.7.1.bias torch.Size([256])
classifier.proposal_head.7.3.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.7.4.weight torch.Size([256])
classifier.proposal_head.7.4.bias torch.Size([256])
classifier.proposal_head.7.6.weight torch.Size([256, 256, 3, 3])
classifier.proposal_head.7.7.weight torch.Size([256])
classifier.proposal_head.7.7.bias torch.Size([256])
classifier.proposal_head.7.9.weight torch.Size([1, 256, 1, 1])
classifier.proposal_head.7.9.bias torch.Size([1])
-----------------------------------------------
prev_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_4_overlap.pth
... weight transfer
Model restored from checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_4_overlap.pth
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)500 len(self.masks)500
...start memory candidates collection
...end memory candidates collection :  600
...start memory list generation
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settrain
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modetrain
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)548 len(self.masks)548
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setval
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
modeval
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)74 len(self.masks)74
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image settest
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)1449 len(self.masks)1449
self.root/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/
image setmemory
use proposal: /home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/proposal_100
memory json location
./datasets/data/swin_voc2012_best_15-1/memory.json
... memory list :  100 [20, 255, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
/home/ud202381360/zxy/IncreSeg/dataset/VOC2012/VOCdevkit/VOC2012/JPEGImages
len(self.images)100 len(self.masks)100
Dataset: voc, Train set: 548, Val set: 74, Test set: 1449
... train epoch : 50 , iterations : 27400 , val_interval : 274
test ckpt_dir checkpoints/%s/%s_%s_%s_step_%d_overlap.pth
best_ckpt checkpoints/swin_voc2012_best/deeplabv3_swin_transformer_voc_15-1_step_5_overlap.pth
color [128   0   0]
(21,)

Overall Acc: 0.931297
Mean Acc: 0.900310
FreqW Acc: 0.888474
Mean IoU: 0.789627
Mean IoU(per pixel): 0.871428
Class IoU/Acc/Recall:
\background: 0.9109 (miou) , 0.9356 (acc) , 0.9718 (rec) 
\aeroplane: 0.9078 (miou) , 0.9529 (acc) , 0.9505 (rec) 
\bicycle: 0.3988 (miou) , 0.7918 (acc) , 0.4455 (rec) 
\bird: 0.9524 (miou) , 0.9720 (acc) , 0.9793 (rec) 
\boat: 0.7409 (miou) , 0.9249 (acc) , 0.7883 (rec) 
\bottle: 0.8626 (miou) , 0.9543 (acc) , 0.8998 (rec) 
\bus: 0.9461 (miou) , 0.9717 (acc) , 0.9730 (rec) 
\car: 0.9018 (miou) , 0.9265 (acc) , 0.9713 (rec) 
\cat: 0.9593 (miou) , 0.9829 (acc) , 0.9756 (rec) 
\chair: 0.5107 (miou) , 0.6004 (acc) , 0.7736 (rec) 
\cow: 0.9479 (miou) , 0.9755 (acc) , 0.9711 (rec) 
\diningtable: 0.6479 (miou) , 0.6939 (acc) , 0.9073 (rec) 
\dog: 0.9450 (miou) , 0.9750 (acc) , 0.9684 (rec) 
\horse: 0.9238 (miou) , 0.9586 (acc) , 0.9622 (rec) 
\motorbike: 0.9148 (miou) , 0.9700 (acc) , 0.9414 (rec) 
\person: 0.8974 (miou) , 0.9258 (acc) , 0.9669 (rec) 
\pottedplant: 0.5983 (miou) , 0.7668 (acc) , 0.7313 (rec) 
\sheep: 0.8852 (miou) , 0.9471 (acc) , 0.9312 (rec) 
\sofa: 0.3197 (miou) , 0.8524 (acc) , 0.3384 (rec) 
\train: 0.8113 (miou) , 0.9542 (acc) , 0.8441 (rec) 
\tvmonitor: 0.5996 (miou) , 0.8744 (acc) , 0.6561 (rec) 

[0.9109051860663953, 0.9078020785180524, 0.39881329708440905, 0.9523887168187488, 0.7408837742564354, 0.8625806386402485, 0.9461273691129536, 0.9018183649777837, 0.9593258273860613, 0.5106624859186936, 0.947926707820134, 0.6479270641865723, 0.9449907488558849, 0.9238083046246249, 0.9147568794414337, 0.8974350719752673]
13.368152515683697
16
...from 0 to 15 : best/test_before_mIoU : 0.835510
[0.5983021664330739, 0.885161512188918, 0.3196773523574078, 0.8112952767902982, 0.5995839398100703]
...from 16 to 20 best/test_after_mIoU : 0.642804
...from 0 to 15 : best/test_before_acc : 0.906973
...from 16 to 20 best/test_after_acc : 0.878987
